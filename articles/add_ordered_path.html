<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Adding ordered path to your ternary plot • prefviz</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Adding ordered path to your ternary plot">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">prefviz</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/add_ordered_path.html">Adding ordered path to your ternary plot</a></li>
    <li><a class="dropdown-item" href="../articles/draw_ternary_plot.html">Using `ternable` object to draw ternary plots</a></li>
    <li><a class="dropdown-item" href="../articles/transform_raw_data.html">Transforming voting data to ternable-friendly format</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/numbats/prefviz/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Adding ordered path to your ternary plot</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/numbats/prefviz/blob/main/vignettes/add_ordered_path.Rmd" class="external-link"><code>vignettes/add_ordered_path.Rmd</code></a></small>
      <div class="d-none name"><code>add_ordered_path.Rmd</code></div>
    </div>

    
    
<p>Adding paths between points in a ternary space can help illustrate
transitions or sequences in the data.</p>
<p>In the example of instant-runoff voting in Australian Federal
Election, these paths can be used to illustrate the change in preference
distribution between rounds of voting in one electorate. This vignette
shows how to add paths to both 2D and high-dimensional ternary
plots.</p>
<div class="section level2">
<h2 id="d-ternary-plot">2D ternary plot<a class="anchor" aria-label="anchor" href="#d-ternary-plot"></a>
</h2>
<p>Take the example of the 2022 Australian Federal Election, we would
like to take a look at the changes in preference distribution across
rounds in three electorates: Higgins, Monash, and Melbourne.</p>
<p>Input data is already in a <code>ternable</code>-friendly format,
with each row representing the preference distribution in one round of
voting in one electorate.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aecdop22_widen</span> <span class="op">&lt;-</span> <span class="fu">prefviz</span><span class="fu">:::</span><span class="va">aecdop22_widen</span></span>
<span><span class="va">input_df</span> <span class="op">&lt;-</span> <span class="va">aecdop22_widen</span> <span class="op">|&gt;</span> </span>
<span>   <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">DivisionNm</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Higgins"</span>, <span class="st">"Monash"</span>, <span class="st">"Melbourne"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">input_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">#&gt;   DivisionNm CountNumber ElectedParty   ALP   LNP Other</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Higgins              0 ALP          0.285 0.407 0.309</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Higgins              1 ALP          0.285 0.407 0.307</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Higgins              2 ALP          0.288 0.409 0.303</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Higgins              3 ALP          0.292 0.411 0.297</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Higgins              4 ALP          0.294 0.416 0.290</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Higgins              5 ALP          0.300 0.448 0.252</span></span>
<span></span>
<span><span class="co"># Create ternable object</span></span>
<span><span class="va">tern22</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ternable.html">ternable</a></span><span class="op">(</span><span class="va">input_df</span>, <span class="va">ALP</span><span class="op">:</span><span class="va">Other</span><span class="op">)</span></span></code></pre></div>
<p>For 2D ternary plots, adding ordered paths is straightforward using
the <code><a href="../reference/stat_ordered_path.html">stat_ordered_path()</a></code> function, and providing the
<code>order_by</code> aesthetic. This is equivalent to
<code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path()</a></code> when you pre-order your data points in the
order you want them to be connected.</p>
<p>In this case, we want to connect the points in the order of round
(<code>order_by = CountNumber</code>) for each electorate
(<code>group = DivisionNm</code>).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The base plot</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ternary_getters.html">get_tern_data</a></span><span class="op">(</span><span class="va">tern22</span>, plot_type <span class="op">=</span> <span class="st">"2D"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">x2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_ternary_cart.html">geom_ternary_cart</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_ternary_region.html">geom_ternary_region</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">vertex_labels</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    vertex_labels <span class="op">=</span> <span class="va">tern22</span><span class="op">$</span><span class="va">vertex_labels</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.3</span>, color <span class="op">=</span> <span class="st">"grey50"</span>,</span>
<span>    show.legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">ElectedParty</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/add_vertex_labels.html">add_vertex_labels</a></span><span class="op">(</span><span class="va">tern22</span><span class="op">$</span><span class="va">simplex_vertices</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ALP"</span> <span class="op">=</span> <span class="st">"red"</span>, <span class="st">"LNP"</span> <span class="op">=</span> <span class="st">"blue"</span>, <span class="st">"Other"</span> <span class="op">=</span> <span class="st">"grey70"</span><span class="op">)</span>,</span>
<span>    aesthetics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fill"</span>, <span class="st">"colour"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Add ordered paths</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="../reference/stat_ordered_path.html">stat_ordered_path</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">DivisionNm</span>, order_by <span class="op">=</span> <span class="va">CountNumber</span>, color <span class="op">=</span> <span class="va">ElectedParty</span><span class="op">)</span>, </span>
<span>  size <span class="op">=</span> <span class="fl">0.5</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="add_ordered_path_files/figure-html/unnamed-chunk-3-1.png" class="r-plt" alt="" width="700"></p>
<p>It’s interesting to see such a close win of ALP in Higgins (red line)
since the result only flipped in the last round. Meanwhile, wins in
Monash and Melbourne were consistent with first preference.</p>
</div>
<div class="section level2">
<h2 id="high-dimensional-ternary-plot">High-dimensional ternary plot<a class="anchor" aria-label="anchor" href="#high-dimensional-ternary-plot"></a>
</h2>
<p>Let’s take a look at Monash and Melbourne in 2025 election, but this
time we will use a high-dimensional ternary plot with 5 parties: ALP,
LNP, GRN, IND, and Other.</p>
<p>Unlike 2D ternary plots, we need to group and order the data before
plotting by providing the <code>group</code> and <code>order_by</code>
arguments when creating ternable object. Since this data is already
ordered by round in the input data frame, we just need to provide the
grouping variable (<code>DivisionNm</code>).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aecdop25_widen</span> <span class="op">&lt;-</span> <span class="fu">prefviz</span><span class="fu">:::</span><span class="va">aecdop25_widen</span></span>
<span><span class="va">input_df2</span> <span class="op">&lt;-</span> <span class="va">aecdop25_widen</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">DivisionNm</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Monash"</span>, <span class="st">"Melbourne"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">input_df2</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 8</span></span></span>
<span><span class="co">#&gt;   DivisionNm CountNumber ElectedParty   ALP   GRN   LNP Other    IND</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Melbourne            0 ALP          0.313     0 0.198 0.439 0.049<span style="text-decoration: underline;">5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Melbourne            1 ALP          0.316     0 0.199 0.444 0.040<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Melbourne            2 ALP          0.321     0 0.201 0.434 0.044<span style="text-decoration: underline;">4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Melbourne            3 ALP          0.326     0 0.212 0.408 0.053<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Melbourne            4 ALP          0.343     0 0.236 0.421 0     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Melbourne            5 ALP          0.530     0 0     0.470 0</span></span>
<span></span>
<span><span class="co"># Create ternable object</span></span>
<span><span class="va">tern25</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ternable.html">ternable</a></span><span class="op">(</span><span class="va">input_df2</span>, <span class="va">ALP</span><span class="op">:</span><span class="va">IND</span>, group <span class="op">=</span> <span class="va">DivisionNm</span><span class="op">)</span></span></code></pre></div>
<p>Adding paths in a high-dimensional ternary plot is made possible by
the <code>edges</code> arguments in <code>display_xy()</code>.
Therefore, besides simplex edges, we need to provide the data edges to
the <code>edges</code> argument. This can be done by setting
<code>include_data = TRUE</code> in <code><a href="../reference/ternary_getters.html">get_tern_edges()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add colors</span></span>
<span><span class="va">party_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"ALP"</span> <span class="op">=</span> <span class="st">"#E13940"</span>,    <span class="co"># Red</span></span>
<span>  <span class="st">"LNP"</span> <span class="op">=</span> <span class="st">"#1C4F9C"</span>,    <span class="co"># Blue</span></span>
<span>  <span class="st">"GRN"</span> <span class="op">=</span> <span class="st">"#10C25B"</span>,    <span class="co"># Green</span></span>
<span>  <span class="st">"IND"</span> <span class="op">=</span> <span class="st">"#F39C12"</span>,    <span class="co"># Orange</span></span>
<span>  <span class="st">"Other"</span> <span class="op">=</span> <span class="st">"#95A5A6"</span>   <span class="co"># Gray</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">color_vector</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  <span class="va">party_colors</span><span class="op">[</span><span class="va">input_df2</span><span class="op">$</span><span class="va">ElectedParty</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">edges_color</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tern25</span><span class="op">$</span><span class="va">simplex_edges</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="va">party_colors</span><span class="op">[</span><span class="va">input_df2</span><span class="op">$</span><span class="va">ElectedParty</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Animate the tour</span></span>
<span><span class="fu">animate_xy</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/ternary_getters.html">get_tern_data</a></span><span class="op">(</span><span class="va">tern25</span>, plot_type <span class="op">=</span> <span class="st">"HD"</span><span class="op">)</span>, </span>
<span>  col <span class="op">=</span> <span class="va">color_vector</span>,</span>
<span>  edges <span class="op">=</span> <span class="fu"><a href="../reference/ternary_getters.html">get_tern_edges</a></span><span class="op">(</span><span class="va">tern25</span>, include_data <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  edges.col <span class="op">=</span> <span class="va">edges_color</span>,</span>
<span>  obs_labels  <span class="op">=</span> <span class="fu"><a href="../reference/ternary_getters.html">get_tern_labels</a></span><span class="op">(</span><span class="va">tern25</span><span class="op">)</span>,</span>
<span>  axes <span class="op">=</span> <span class="st">"bottomleft"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="add_ordered_path_files/figure-html/unnamed-chunk-5-1.png" class="r-plt" alt="" width="700"><img src="add_ordered_path_files/figure-html/unnamed-chunk-5-2.png" class="r-plt" alt="" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/linhngo66" class="external-link">Linh Ngo</a>, <a href="https://github.com/dicook" class="external-link">Dianne Cook</a>, <a href="https://damjan.vukcevic.net/" class="external-link">Damjan Dvukcevic</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
